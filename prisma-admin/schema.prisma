generator client {
  provider        = "prisma-client-js"
  output          = "../node_modules/.prisma/admin"
  previewFeatures = ["typedSql"]
}

datasource db {
  provider = "postgresql"
  url      = env("ADMIN_DATABASE_URL")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model animal {
  animal_id   Int         @id @default(autoincrement())
  animal_name String      @db.VarChar(40)
  animal_born DateTime?   @db.Date
  owner_id    Int
  at_id       Int
  animal_type animal_type @relation(fields: [at_id], references: [at_id], onDelete: NoAction, onUpdate: NoAction)
  owners      owners      @relation(fields: [owner_id], references: [owner_id], onDelete: NoAction, onUpdate: NoAction)
  visit       visit[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model animal_type {
  at_id          Int      @id @default(autoincrement())
  at_description String   @db.VarChar(40)
  animal         animal[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model clinic {
  clinic_id      Int          @id @default(autoincrement())
  clinic_name    String       @db.VarChar(50)
  clinic_address String?      @db.VarChar(80)
  clinic_phone   String?      @db.VarChar(14)
  spec_visit     spec_visit[]
  vet            vet[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model drug {
  drug_id    Int          @id @default(autoincrement())
  drug_name  String       @db.VarChar(50)
  drug_usage String?      @db.VarChar(100)
  visit_drug visit_drug[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model owners {
  owner_id         Int      @id @default(autoincrement())
  owner_givenname  String   @db.VarChar(30)
  owner_familyname String   @db.VarChar(30)
  owner_address    String?  @db.VarChar(100)
  owner_phone      String?  @db.VarChar(14)
  email            String?  @unique @db.VarChar(100)
  password         String?  @db.VarChar(255)
  animal           animal[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model spec_visit {
  clinic_id Int
  vet_id    Int
  sv_count  Int?
  clinic    clinic @relation(fields: [clinic_id], references: [clinic_id], onDelete: NoAction, onUpdate: NoAction)
  vet       vet    @relation(fields: [vet_id], references: [vet_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([clinic_id, vet_id])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model specialisation {
  spec_id          Int    @id @default(autoincrement())
  spec_description String @db.VarChar(30)
  vet              vet[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model vet {
  vet_id         Int             @id @default(autoincrement())
  vet_title      String?         @db.Char(4)
  vet_givenname  String          @db.VarChar(30)
  vet_familyname String          @db.VarChar(30)
  vet_phone      String?         @db.VarChar(14)
  vet_employed   DateTime?       @db.Date
  spec_id        Int?
  clinic_id      Int?
  email          String?         @unique @db.VarChar(100)
  password       String?         @db.VarChar(255)
  spec_visit     spec_visit[]
  clinic         clinic?         @relation(fields: [clinic_id], references: [clinic_id], onDelete: NoAction, onUpdate: NoAction)
  specialisation specialisation? @relation(fields: [spec_id], references: [spec_id], onDelete: NoAction, onUpdate: NoAction)
  visit          visit[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model visit {
  visit_id        Int          @id @default(autoincrement())
  visit_date_time DateTime?    @db.Timestamp(6)
  visit_notes     String?      @db.VarChar(200)
  animal_id       Int
  vet_id          Int
  from_visit_id   Int?
  animal          animal       @relation(fields: [animal_id], references: [animal_id], onDelete: NoAction, onUpdate: NoAction)
  visit           visit?       @relation("visitTovisit", fields: [from_visit_id], references: [visit_id], onDelete: NoAction, onUpdate: NoAction)
  other_visit     visit[]      @relation("visitTovisit")
  vet             vet          @relation(fields: [vet_id], references: [vet_id], onDelete: NoAction, onUpdate: NoAction)
  visit_drug      visit_drug[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model visit_drug {
  visit_id               Int
  drug_id                Int
  visit_drug_dose        String? @db.VarChar(20)
  visit_drug_frequency   String? @db.VarChar(20)
  visit_drug_qtysupplied Int?
  drug                   drug    @relation(fields: [drug_id], references: [drug_id], onDelete: NoAction, onUpdate: NoAction)
  visit                  visit   @relation(fields: [visit_id], references: [visit_id], onDelete: NoAction, onUpdate: NoAction)

  @@id([visit_id, drug_id])
}

model admin {
  id       Int    @id @default(autoincrement())
  username String @unique @db.VarChar(50)
  email    String @unique @db.VarChar(100)
  password String @db.VarChar(255)
  name     String @db.VarChar(100)
}

enum role {
  admin
  vet
  owner
}
